<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RS INFINITY - AI SYSTEM</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

    <style>
        /* --- VISUAL IDENTITY: Premium Dark Tech --- */
        :root {
            --gold-primary: #FFD700;
            --gold-dark: #B8860B;
            --bg-dark: #050505;
            --glass-bg: rgba(20, 20, 20, 0.85);
            --glass-border: rgba(255, 215, 0, 0.2);
        }

        body {
            font-family: 'Kanit', sans-serif;
            background-color: var(--bg-dark);
            background-image: 
                linear-gradient(rgba(0,0,0,0.9), rgba(0,0,0,0.9)),
                repeating-linear-gradient(45deg, #111 0, #111 1px, transparent 0, transparent 50%);
            background-size: 20px 20px;
            color: #ffffff;
            overflow-x: hidden;
            height: 100vh;
        }

        /* Glassmorphism */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        /* Typography */
        .font-tech { font-family: 'Rajdhani', sans-serif; }
        .text-gold { 
            background: linear-gradient(to bottom, #FFD700, #FDB931);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0px 0px 10px rgba(255, 215, 0, 0.3);
        }

        /* Interactive Elements */
        .btn-scan {
            background: linear-gradient(135deg, #FFD700, #B8860B);
            animation: pulse-gold 2s infinite;
        }
        .btn-click:active { transform: scale(0.95); transition: transform 0.1s; }
        
        @keyframes pulse-gold {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        /* Helper Classes */
        .hidden-page { display: none !important; }
        .grayscale-mode { filter: grayscale(100%); pointer-events: none; opacity: 0.5; }
        .loader-ring {
            border: 4px solid #333;
            border-top: 4px solid var(--gold-primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Bottom Nav */
        .bottom-nav {
            background: rgba(10, 10, 10, 0.95);
            border-top: 1px solid var(--glass-border);
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .nav-item.active { color: var(--gold-primary); }
    </style>
</head>
<body class="flex flex-col h-screen">

    <div id="loading-screen" class="fixed inset-0 z-50 flex items-center justify-center bg-black">
        <div class="text-center">
            <div class="loader-ring mx-auto mb-4"></div>
            <h1 class="text-2xl font-bold tracking-widest text-gold italic">CONNECTING...</h1>
            <p id="loading-text" class="text-xs text-gray-500 mt-2">Connecting to Firestore</p>
        </div>
    </div>

    <div id="auth-screen" class="hidden-page fixed inset-0 z-40 flex items-center justify-center p-6 bg-black/80 backdrop-blur-sm">
        <div class="glass-panel w-full max-w-sm p-8 rounded-2xl relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-yellow-500 to-transparent"></div>
            
            <h2 id="auth-title" class="text-3xl font-bold text-center mb-6 italic text-gold">LOGIN</h2>
            
            <form id="login-form" class="space-y-4">
                <div>
                    <label class="text-xs text-gray-400">Email</label>
                    <input type="email" id="email" class="w-full bg-black/50 border border-gray-700 rounded-lg p-3 text-white focus:border-yellow-500 outline-none" placeholder="example@email.com" required>
                </div>
                <div>
                    <label class="text-xs text-gray-400">Password</label>
                    <input type="password" id="password" class="w-full bg-black/50 border border-gray-700 rounded-lg p-3 text-white focus:border-yellow-500 outline-none" placeholder="••••••••" required>
                </div>
                <button type="submit" id="auth-btn" class="w-full bg-gradient-to-r from-yellow-600 to-yellow-400 text-black font-bold py-3 rounded-lg btn-click mt-4">เข้าสู่ระบบ</button>
            </form>

            <div class="mt-6 text-center text-sm text-gray-400" id="auth-switch">
                ยังไม่มีบัญชี? <span onclick="toggleAuthMode()" class="text-yellow-400 cursor-pointer underline">สมัครสมาชิก</span>
            </div>
            <div id="auth-error" class="text-red-500 text-xs text-center mt-2 hidden"></div>
        </div>
    </div>

    <div id="app-container" class="hidden-page flex-1 flex flex-col relative">
        
        <header class="flex justify-between items-center p-5 pt-8">
            <div class="flex items-center gap-2">
                <i class="fa-solid fa-bolt text-yellow-500"></i>
                <h1 class="text-xl font-bold italic tracking-wide">RS <span class="text-gold">INFINITY</span></h1>
            </div>
            <div class="flex items-center gap-3">
                 <span id="header-status" class="text-[10px] px-2 py-1 rounded bg-gray-800 text-gray-400">CHECKING</span>
                <div class="w-10 h-10 rounded-full bg-gray-800 border border-yellow-500/50 flex items-center justify-center overflow-hidden">
                    <i class="fa-solid fa-user text-gray-400"></i>
                </div>
            </div>
        </header>

        <main class="flex-1 overflow-y-auto pb-24 px-4 relative">
            
            <div id="home-page" class="space-y-6">
                <div class="glass-panel p-4 rounded-xl flex justify-between items-center">
                    <div>
                        <div class="text-xs text-gray-400">BTC/USDT</div>
                        <div id="btc-price" class="text-2xl font-tech font-bold text-white">$...</div>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-gray-400">ETH/USDT</div>
                        <div id="eth-price" class="text-lg font-tech font-bold text-white">$...</div>
                    </div>
                </div>

                <div class="relative py-10 flex justify-center">
                    <button id="scan-btn" onclick="openScannerModal()" class="btn-scan w-48 h-48 rounded-full flex flex-col items-center justify-center relative z-10 btn-click shadow-[0_0_30px_rgba(255,215,0,0.3)] border-4 border-black">
                        <i class="fa-solid fa-fingerprint text-4xl text-black mb-2"></i>
                        <span class="text-black font-bold text-lg">SCAN MARKET</span>
                        <span class="text-black/70 text-xs">AI Processing</span>
                    </button>
                    <div class="absolute inset-0 bg-yellow-500/10 blur-3xl rounded-full z-0 transform scale-75"></div>
                </div>

                <div id="expired-alert" class="hidden glass-panel p-4 rounded-xl border-red-500/50 bg-red-900/20 text-center animate-pulse">
                    <i class="fa-solid fa-lock text-red-500 text-2xl mb-2"></i>
                    <h3 class="text-red-400 font-bold">ACCOUNT EXPIRED</h3>
                    <p class="text-xs text-gray-300 mt-1">กรุณาติดต่อแอดมินเพื่อเติมวันใช้งาน</p>
                </div>
            </div>

            <div id="chart-page" class="hidden-page h-full flex flex-col">
                <div class="glass-panel p-2 mb-2 rounded-lg flex gap-2 overflow-x-auto">
                    <button onclick="changeChart('BTCUSDT')" class="px-4 py-1 rounded bg-yellow-500/20 text-yellow-500 text-xs border border-yellow-500/50">BTC</button>
                    <button onclick="changeChart('ETHUSDT')" class="px-4 py-1 rounded bg-gray-800 text-gray-400 text-xs">ETH</button>
                    <button onclick="changeChart('XAUUSD')" class="px-4 py-1 rounded bg-gray-800 text-gray-400 text-xs">GOLD</button>
                </div>
                <div id="tv_chart_container" class="flex-1 rounded-xl overflow-hidden glass-panel"></div>
            </div>

            <div id="profile-page" class="hidden-page space-y-6">
                <div class="glass-panel p-6 rounded-2xl relative overflow-hidden bg-gradient-to-br from-gray-900 to-black border border-gray-800">
                    <div class="flex justify-between items-start mb-8">
                        <div class="italic text-gold font-bold text-lg">VIP MEMBER</div>
                        <i class="fa-brands fa-bitcoin text-gray-700 text-4xl"></i>
                    </div>
                    <div class="mb-2">
                        <div class="text-xs text-gray-500">ACCOUNT EMAIL</div>
                        <div id="profile-email" class="text-sm font-tech tracking-wider">...</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">TIME REMAINING</div>
                        <div id="countdown" class="text-3xl font-tech font-bold text-white tracking-widest">LOADING...</div>
                    </div>
                </div>

                <div class="space-y-3">
                    <button id="contact-admin-btn" class="w-full glass-panel p-4 rounded-xl flex items-center justify-between btn-click">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-green-900/50 flex items-center justify-center text-green-500"><i class="fa-brands fa-line"></i></div>
                            <span>ติดต่อแอดมิน (Support)</span>
                        </div>
                        <i class="fa-solid fa-chevron-right text-gray-600"></i>
                    </button>
                    
                    <button onclick="logout()" class="w-full glass-panel p-4 rounded-xl flex items-center justify-between btn-click text-red-400 border-red-900/30">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-red-900/20 flex items-center justify-center"><i class="fa-solid fa-power-off"></i></div>
                            <span>ออกจากระบบ</span>
                        </div>
                    </button>
                </div>
            </div>

        </main>

        <nav class="bottom-nav fixed bottom-0 w-full h-20 flex justify-around items-center px-2 z-30">
            <button onclick="switchTab('home')" class="nav-item active flex flex-col items-center gap-1 p-2 btn-click" id="nav-home">
                <i class="fa-solid fa-house text-xl"></i>
                <span class="text-[10px]">Home</span>
            </button>
            <button onclick="switchTab('chart')" class="nav-item text-gray-500 flex flex-col items-center gap-1 p-2 btn-click" id="nav-chart">
                <i class="fa-solid fa-chart-simple text-xl"></i>
                <span class="text-[10px]">Chart</span>
            </button>
            <button onclick="switchTab('profile')" class="nav-item text-gray-500 flex flex-col items-center gap-1 p-2 btn-click" id="nav-profile">
                <i class="fa-solid fa-user-astronaut text-xl"></i>
                <span class="text-[10px]">Profile</span>
            </button>
        </nav>
    </div>

    <div id="scanner-modal" class="hidden fixed inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center">
        <div class="glass-panel w-full max-w-xs p-6 rounded-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gold">AI SETUP</h3>
                <button onclick="closeModal('scanner-modal')" class="text-gray-400"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-gray-400 mb-2 block">ASSET</label>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="selectAsset(this, 'BTC')" class="asset-btn bg-yellow-500 text-black font-bold py-2 rounded border border-yellow-500">BTC</button>
                        <button onclick="selectAsset(this, 'ETH')" class="asset-btn bg-gray-800 text-gray-400 py-2 rounded border border-gray-700">ETH</button>
                        <button onclick="selectAsset(this, 'XAU')" class="asset-btn bg-gray-800 text-gray-400 py-2 rounded border border-gray-700">GOLD</button>
                    </div>
                </div>
                <div>
                    <label class="text-xs text-gray-400 mb-2 block">TIMEFRAME</label>
                    <div class="grid grid-cols-4 gap-2">
                        <button onclick="selectTF(this, '1m')" class="tf-btn bg-gray-800 text-gray-400 py-2 rounded text-xs">1m</button>
                        <button onclick="selectTF(this, '5m')" class="tf-btn bg-yellow-500 text-black font-bold py-2 rounded text-xs">5m</button>
                        <button onclick="selectTF(this, '15m')" class="tf-btn bg-gray-800 text-gray-400 py-2 rounded text-xs">15m</button>
                        <button onclick="selectTF(this, '30m')" class="tf-btn bg-gray-800 text-gray-400 py-2 rounded text-xs">30m</button>
                    </div>
                </div>
                <button onclick="startScanning()" class="w-full bg-gradient-to-r from-yellow-600 to-yellow-400 text-black font-bold py-3 rounded-xl mt-2 btn-click">START AI</button>
            </div>
        </div>
    </div>

    <div id="processing-modal" class="hidden fixed inset-0 z-[60] bg-black flex flex-col items-center justify-center">
        <div class="relative w-64 h-64">
            <div class="absolute inset-0 border-4 border-gray-800 rounded-full"></div>
            <div class="absolute inset-0 border-t-4 border-yellow-500 rounded-full animate-spin"></div>
            <div class="absolute inset-0 flex items-center justify-center">
                <i class="fa-solid fa-robot text-5xl text-gray-200"></i>
            </div>
        </div>
        <h2 class="mt-8 text-2xl font-bold animate-pulse text-gold">ANALYZING...</h2>
    </div>

    <div id="result-modal" class="hidden fixed inset-0 z-[70] bg-black/95 backdrop-blur-xl flex items-center justify-center p-6">
        <div class="w-full max-w-sm border border-gray-800 bg-gray-900 rounded-2xl p-8 text-center">
            <div id="signal-badge" class="inline-block px-6 py-2 rounded-full mb-6 text-xl font-bold">BUY SIGNAL</div>
            <div class="flex justify-between items-center mb-4 border-b border-gray-800 pb-4">
                <span class="text-gray-400">Pair</span><span id="res-pair" class="font-bold text-xl">BTC/USDT</span>
            </div>
            <div class="flex justify-between items-center mb-8">
                <span class="text-gray-400">Entry</span><span class="font-tech text-gold text-lg">Market Price</span>
            </div>
            <button onclick="closeModal('result-modal')" class="w-full py-3 rounded-lg border border-gray-700">Close</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Your Config
        const firebaseConfig = {
            apiKey: "AIzaSyBNfTBQthLLRbJP9BXZ-UQptFsdU324Mv0",
            authDomain: "fafada-d9899.firebaseapp.com",
            projectId: "fafada-d9899",
            storageBucket: "fafada-d9899.appspot.com",
            messagingSenderId: "484777586908",
            appId: "1:484777586908:web:16a8f0367ad15737364419"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // State
        let currentUser = null;
        let expiryTimer = null;
        let isExpired = true;
        let adminLink = "#"; 
        
        // --- 1. AUTH SYSTEM ---
        const loginForm = document.getElementById('login-form');
        const authError = document.getElementById('auth-error');
        let isLoginMode = true;

        // Monitor Auth State
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log("User logged in:", user.email);
                currentUser = user;
                initUserData(user.uid);
            } else {
                console.log("No user");
                showAuthScreen();
            }
        });

        function showAuthScreen() {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('app-container').classList.add('hidden-page');
            document.getElementById('auth-screen').classList.remove('hidden-page');
        }

        function showAppScreen() {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('auth-screen').classList.add('hidden-page');
            document.getElementById('app-container').classList.remove('hidden-page');
            loadTradingView('BTCUSDT');
        }

        // Login/Register Toggle
        window.toggleAuthMode = () => {
            isLoginMode = !isLoginMode;
            document.getElementById('auth-title').innerText = isLoginMode ? "LOGIN" : "REGISTER";
            document.getElementById('auth-btn').innerText = isLoginMode ? "เข้าสู่ระบบ" : "สมัครสมาชิกทันที";
            document.querySelector('#auth-switch span').innerText = isLoginMode ? "สมัครสมาชิก" : "เข้าสู่ระบบ";
            document.querySelector('#auth-switch').firstChild.nodeValue = isLoginMode ? "ยังไม่มีบัญชี? " : "มีบัญชีแล้ว? ";
            authError.classList.add('hidden');
        };

        // Handle Submit
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            authError.classList.add('hidden');

            document.getElementById('loading-text').innerText = "Authenticating...";
            document.getElementById('loading-screen').style.display = 'flex';

            try {
                if (isLoginMode) {
                    await signInWithEmailAndPassword(auth, email, password);
                } else {
                    const cred = await createUserWithEmailAndPassword(auth, email, password);
                    // Create User in Firestore immediately
                    await setDoc(doc(db, "users", cred.user.uid), {
                        email: email,
                        createdAt: serverTimestamp(),
                        expiryDate: new Date() // Expired by default
                    });
                }
            } catch (error) {
                document.getElementById('loading-screen').style.display = 'none';
                authError.innerText = error.message;
                authError.classList.remove('hidden');
                console.error("Auth Error:", error);
            }
        });

        window.logout = () => signOut(auth);

        // --- 2. DATABASE & REALTIME ---
        function initUserData(uid) {
            document.getElementById('loading-text').innerText = "Syncing Profile...";
            
            // 1. Listen to User Data
            onSnapshot(doc(db, "users", uid), (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    document.getElementById('profile-email').innerText = data.email;
                    handleExpiry(data.expiryDate);
                    showAppScreen();
                } else {
                    // Safety: Create doc if missing
                    setDoc(doc(db, "users", uid), { 
                        email: currentUser.email, 
                        expiryDate: new Date() 
                    }).then(() => console.log("Created missing user doc"));
                }
            }, (error) => {
                console.error("Firestore Error:", error);
                alert("Database Connection Failed! กรุณาตรวจสอบว่าตั้งค่า Firestore Rules เป็น Test Mode แล้วหรือยัง");
            });

            // 2. Listen to System Config
            onSnapshot(doc(db, "system", "config"), (docSnap) => {
                if (docSnap.exists()) {
                    adminLink = docSnap.data().contactLink;
                }
            });
        }

        // --- 3. EXPIRY LOGIC ---
        function handleExpiry(expiryTimestamp) {
            if (!expiryTimestamp) return;
            const expiryDate = expiryTimestamp.toDate ? expiryTimestamp.toDate() : new Date(expiryTimestamp);

            if (expiryTimer) clearInterval(expiryTimer);
            
            expiryTimer = setInterval(() => {
                const now = new Date();
                const diff = expiryDate - now;

                if (diff <= 0) {
                    document.getElementById('countdown').innerText = "EXPIRED";
                    document.getElementById('countdown').classList.add('text-red-500');
                    document.getElementById('expired-alert').classList.remove('hidden');
                    document.getElementById('scan-btn').classList.add('grayscale-mode');
                    document.getElementById('header-status').innerText = "EXPIRED";
                    document.getElementById('header-status').className = "text-[10px] px-2 py-1 rounded bg-red-900 text-red-400";
                    isExpired = true;
                    clearInterval(expiryTimer);
                } else {
                    // Format
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    document.getElementById('countdown').innerText = `${pad(days)}D : ${pad(hours)}H : ${pad(minutes)}M : ${pad(seconds)}S`;
                    document.getElementById('countdown').classList.remove('text-red-500');
                    document.getElementById('expired-alert').classList.add('hidden');
                    document.getElementById('scan-btn').classList.remove('grayscale-mode');
                    document.getElementById('header-status').innerText = "ACTIVE";
                    document.getElementById('header-status').className = "text-[10px] px-2 py-1 rounded bg-green-900 text-green-400";
                    isExpired = false;
                }
            }, 1000);
        }

        function pad(n) { return n < 10 ? '0' + n : n; }

        // --- 4. APP INTERACTION ---
        let selectedAsset = 'BTC';
        let selectedTF = '5m';

        window.openScannerModal = () => {
            if (isExpired) {
                alert("แพ็กเกจหมดอายุ! กรุณาเติมวันใช้งาน");
                return;
            }
            document.getElementById('scanner-modal').classList.remove('hidden');
        };
        
        window.closeModal = (id) => document.getElementById(id).classList.add('hidden');
        
        window.selectAsset = (el, asset) => {
            document.querySelectorAll('.asset-btn').forEach(b => b.className = "asset-btn bg-gray-800 text-gray-400 py-2 rounded border border-gray-700");
            el.className = "asset-btn bg-yellow-500 text-black font-bold py-2 rounded border border-yellow-500";
            selectedAsset = asset;
        };

        window.selectTF = (el, tf) => {
            document.querySelectorAll('.tf-btn').forEach(b => b.className = "tf-btn bg-gray-800 text-gray-400 py-2 rounded text-xs");
            el.className = "tf-btn bg-yellow-500 text-black font-bold py-2 rounded text-xs";
            selectedTF = tf;
        };

        window.startScanning = () => {
            closeModal('scanner-modal');
            document.getElementById('processing-modal').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('processing-modal').classList.add('hidden');
                showResult();
            }, 3000);
        };

        function showResult() {
            const isBuy = Math.random() > 0.5;
            const badge = document.getElementById('signal-badge');
            
            if (isBuy) {
                badge.innerText = "BUY SIGNAL";
                badge.className = "inline-block px-6 py-2 rounded-full mb-6 text-xl font-bold bg-green-500/20 text-green-500 border border-green-500 shadow-[0_0_20px_rgba(34,197,94,0.3)]";
            } else {
                badge.innerText = "SELL SIGNAL";
                badge.className = "inline-block px-6 py-2 rounded-full mb-6 text-xl font-bold bg-red-500/20 text-red-500 border border-red-500 shadow-[0_0_20px_rgba(239,68,68,0.3)]";
            }
            
            document.getElementById('res-pair').innerText = selectedAsset + "/USDT";
            document.getElementById('result-modal').classList.remove('hidden');
        }

        // Contact Admin
        document.getElementById('contact-admin-btn').addEventListener('click', () => {
            if(adminLink && adminLink !== '#') window.open(adminLink, '_blank');
            else alert("Admin link not set yet.");
        });

        // Navigation
        window.switchTab = (tab) => {
            ['home-page', 'chart-page', 'profile-page'].forEach(id => document.getElementById(id).classList.add('hidden-page'));
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('active', 'text-gold');
                el.classList.add('text-gray-500');
            });

            document.getElementById(tab + '-page').classList.remove('hidden-page');
            document.getElementById('nav-' + tab).classList.add('active', 'text-gold');
            document.getElementById('nav-' + tab).classList.remove('text-gray-500');
        };

        // Price Ticker
        setInterval(async () => {
            try {
                const res = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');
                const data = await res.json();
                document.getElementById('btc-price').innerText = "$" + parseFloat(data.price).toFixed(2);
                
                const res2 = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT');
                const data2 = await res2.json();
                document.getElementById('eth-price').innerText = "$" + parseFloat(data2.price).toFixed(2);
            } catch {}
        }, 5000);

        // Chart
        window.changeChart = (symbol) => loadTradingView(symbol);
        function loadTradingView(symbol) {
            document.getElementById('tv_chart_container').innerHTML = "";
            new TradingView.widget({
                "width": "100%", "height": "100%",
                "symbol": symbol === 'XAUUSD' ? "OANDA:XAUUSD" : "BINANCE:" + symbol,
                "interval": "15", "timezone": "Asia/Bangkok", "theme": "dark", "style": "1",
                "container_id": "tv_chart_container", "backgroundColor": "rgba(0, 0, 0, 1)",
                "hide_top_toolbar": true
            });
        }
    </script>
</body>
</html>
